{% extends "two_factor/_base.html" %}

{% load i18n %}

{% block two_factor_content %}
    <h3>
        {% block title %}{% trans "Enable Two-Factor Authentication" %}{% endblock %}

        <small>
            {% if wizard.steps.current == 'welcome' %}
                {% blocktrans trimmed %}
                    You are about to take your account security to the next level. Follow the steps in this wizard to
                    enable two-factor authentication.
                {% endblocktrans %}
            {% elif wizard.steps.current == 'method' %}
                {% blocktrans trimmed %}
                    Please select which authentication method you would like to use.
                {% endblocktrans %}
            {% elif wizard.steps.current == 'generator' %}
                {% blocktrans trimmed %}
                    To start using a token generator, please use your smartphone to scan the QR code below. For example,
                    use Google Authenticator. Then, enter the token generated by the app.
                {% endblocktrans %}
            {% elif wizard.steps.current == 'validation' %}
                {% blocktrans trimmed %}
                    Please validate the code that have received via your selected method.
                {% endblocktrans %}
            {% endif %}
        </small>
    </h3>

    {% if wizard.steps.current == 'generator' %}
        <div class="row-fluid section">
            <div class="span12">
                <p>
                    <img src="{{ QR_URL }}" alt="QR Code" style="background: white;" />
                </p>

                <p>
                    {% blocktrans trimmed %}
                        If you are unable to scan the QR code above, please use the following key instead:
                    {% endblocktrans %}
                </p>
                <p>
                    {{ secret_key }}
                </p>
            </div>
        </div>
    {% elif wizard.steps.current == 'validation' %}
        {% if not challenge_succeeded %}
            <p class="alert alert-warning" role="alert">
                {% blocktrans trimmed %}
                    We've encountered an issue with the selected authentication method. Please go back and verify
                    that you entered your information correctly, try again, or use a different authentication
                    method instead. If the issue persists, please contact us.
                {% endblocktrans %}
            </p>
        {% endif %}
    {% endif %}

    <form action="" method="post" class="form form-vertical" novalidate>{% csrf_token %}
        {% include "two_factor/_wizard_forms.html" %}

        {# hidden submit button to enable [enter] key #}
        <input type="submit" value="" class="hidden" />

        {% include "two_factor/_wizard_actions.html" %}
    </form>
{% endblock %}
