{% load i18n %}

<template id="like-or-bookmarked-template">
    <tr>
        <td class="user">
            <a href=""></a>
        </td>
        <td class="created-on">
            <abbr class="timestamp" data-epoch="">...</abbr>
        </td>
    </tr>
</template>

<script type="text/javascript">
    function onLikeOrBoorkmarkedSuccess(data, $loading, $table) {
        var properties = JSON.parse(data);

        $loading.hide();
        $table.removeClass('hide');
        $table.find('tr').remove();

        if (properties.length === 0) {
            {% trans "There doesn't seem to be anything here." as message %}
            var message = '{{ message|escapejs }}';
            $table.append('<tr><td>' + message + '</td></tr>');
        } else {
            var t = document.querySelector('#like-or-bookmarked-template');

            properties.forEach(function (property) {
                var displayName = property[1] || property[0];
                var username = property[0];
                var createdOn = property[2];

                t.content.querySelector('.user a').textContent = displayName;
                t.content.querySelector('.user a').href = '/users/' + username + '/';
                t.content.querySelector('.created-on abbr').setAttribute('data-epoch', new Date(createdOn + 'Z').getTime());
                $table.append(document.importNode(t.content, true));
            });

            astrobin_common.init_timestamps();
        }
    }
</script>
