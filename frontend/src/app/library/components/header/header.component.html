<nav class="navbar navbar-expand-lg">
  <div class="container">

    <a class="navbar-brand" [href]="legacyRoutes.HOME">
      <img src="assets/images/nav-logo.png" alt="AstroBin" />
    </a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" [attr.aria-expanded]="!isCollapsed" aria-label="Toggle navigation"
      (click)="isCollapsed = !isCollapsed">
      <fa-icon icon="bars"></fa-icon>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent" [ngbCollapse]="isCollapsed">
      <ul class="navbar-nav mr-auto mt-2 mt-lg-0">

        <!-- Moderate menu -->
        <li class="nav-item" *ngIf="appContext.currentUserProfile | isContentModerator">
          <div ngbDropdown class="d-inline-block">
            <button id="moderateDropdown" class="btn btn-link" ngbDropdownToggle translate>Moderate</button>
            <div ngbDropdownMenu aria-labelledby="moderateDropdown">

              <h6 class="dropdown-header" translate>Images</h6>

              <a class="dropdown-item" *ngIf="appContext.currentUserProfile | isImageModerator"
                [href]="legacyRoutes.MODERATE_IMAGE_QUEUE">
                <fa-icon icon="images"></fa-icon>
                {{ "Image queue" | translate }}
              </a>

              <a class="dropdown-item"
                *ngIf="(appContext.currentUserProfile | isImageModerator) &&
                     (appContext.currentUserProfile | isSuperuser)"
                [href]="legacyRoutes.MODERATE_SPAM_QUEUE">
                <fa-icon icon="flag"></fa-icon>
                {{ "Spam queue" | translate }}
              </a>

              <ng-container *ngIf="appContext.currentUserProfile | isIotdStaff">
                <div class="dropdown-divider"></div>
                <h6 class="dropdown-header" translate>Image of the day</h6>

                <a class="dropdown-item" *ngIf="appContext.currentUserProfile | isIotdSubmitter"
                  [href]="legacyRoutes.IOTD_SUBMISSION_QUEUE">
                  <fa-icon icon="upload"></fa-icon>
                  {{ "Submission queue" | translate }}
                </a>

                <a class="dropdown-item" *ngIf="appContext.currentUserProfile | isIotdReviewer"
                  [href]="legacyRoutes.IOTD_REVIEW_QUEUE">
                  <fa-icon icon="star"></fa-icon>
                  {{ "Review queue" | translate }}
                </a>

                <a class="dropdown-item" *ngIf="appContext.currentUserProfile | isIotdJudge"
                  [href]="legacyRoutes.IOTD_JUDGEMENT_QUEUE">
                  <fa-icon icon="hammer"></fa-icon>
                  {{ "Judgement queue" | translate }}
                </a>
              </ng-container>

            </div>
          </div>
        </li>
        <!-- ./Moderate menu -->

        <!-- Forum menu -->
        <li class="nav-item">
          <div ngbDropdown class="d-inline-block">
            <button id="forumDropdown" class="btn btn-link" ngbDropdownToggle translate>Forum</button>
            <div ngbDropdownMenu aria-labelledby="forumDropdown">

              <a class="dropdown-item" [href]="legacyRoutes.FORUM_HOME">
                <fa-icon icon="comments"></fa-icon>
                {{ "Home" | translate }}
              </a>

              <a class="dropdown-item" [href]="legacyRoutes.FORUM_LATEST">
                <fa-icon icon="sort-amount-down"></fa-icon>
                {{ "Latest topics" | translate }}
              </a>

              <a class="dropdown-item" [href]="legacyRoutes.FORUM_SUBSCRIBED">
                <fa-icon icon="eye"></fa-icon>
                {{ "Subscribed topics" | translate }}
              </a>

            </div>
          </div>
        </li>
        <!-- ./Forum menu -->

        <!-- Explore menu -->
        <li class="nav-item">
          <div ngbDropdown class="d-inline-block">
            <button id="exploreDropdown" class="btn btn-link" ngbDropdownToggle translate>Explore</button>
            <div ngbDropdownMenu aria-labelledby="exploreDropdown">

              <a class="dropdown-item" [href]="legacyRoutes.SEARCH">
                <fa-icon icon="search"></fa-icon>
                {{ "The Big Wall / Advanced search" | translate }}
              </a>

              <div class="dropdown-divider"></div>

              <a class="dropdown-item" [href]="legacyRoutes.TOP_PICKS">
                <fa-icon icon="star"></fa-icon>
                {{ "Top Picks" | translate }}
              </a>

              <a class="dropdown-item" [href]="legacyRoutes.IOTD">
                <fa-icon icon="trophy"></fa-icon>
                {{ "Image of the day" | translate }}
              </a>

              <div class="dropdown-divider"></div>

              <a class="dropdown-item" [href]="legacyRoutes.GROUPS">
                <fa-icon icon="users"></fa-icon>
                {{ "Groups" | translate }}
              </a>

              <a class="dropdown-item" [href]="legacyRoutes.RAWDATA_PUBLIC_DATA_POOLS">
                <fa-icon icon="book"></fa-icon>
                {{ "Public data pools" | translate }}
              </a>

              <div class="dropdown-divider"></div>

              <a class="dropdown-item" [href]="legacyRoutes.TRENDING_ASTROPHOTOGRAPHERS">
                <fa-icon icon="list-ol"></fa-icon>
                {{ "Trending astrophotographers" | translate }}
              </a>

            </div>
          </div>
        </li>
        <!-- ./Explore menu -->

        <!-- Help menu -->
        <li class="nav-item">
          <div ngbDropdown class="d-inline-block">
            <button id="helpDropdown" class="btn btn-link" ngbDropdownToggle translate>Help</button>
            <div ngbDropdownMenu aria-labelledby="helpDropdown">

              <a class="dropdown-item" [href]="legacyRoutes.HELP">
                <fa-icon icon="info"></fa-icon>
                {{ "What is this site?" | translate }}
              </a>

              <div class="dropdown-divider"></div>

              <a class="dropdown-item" [href]="legacyRoutes.FAQ">
                <fa-icon icon="question"></fa-icon>
                {{ "FAQ" | translate }}
              </a>

              <a class="dropdown-item" [href]="legacyRoutes.RAWDATA_HELP">
                <fa-icon icon="book"></fa-icon>
                {{ "AstroBin Raw Data" | translate }}
              </a>

              <div class="dropdown-divider"></div>

              <a class="dropdown-item" [href]="legacyRoutes.HELP_API">
                <fa-icon icon="key"></fa-icon>
                {{ "API (beta)" | translate }}
              </a>

              <a class="dropdown-item" [href]="legacyRoutes.CONTACT">
                <fa-icon icon="envelope"></fa-icon>
                {{ "Contact" | translate }}
              </a>

            </div>
          </div>
        </li>
        <!-- ./Help menu -->

        <!-- Quick search form -->
        <li class="nav-item quick-search">
          <form [action]="legacyRoutes.SEARCH" method="get">
            <input type="text" name="q" placeholder="{{ 'Quick search' | translate }}" />
          </form>
        </li>
        <!-- ./Quick search form -->

      </ul>

      <ul *ngIf="!appContext.currentUserProfile.userObject" class="navbar-nav">
        <li class="nav-item"><a class="nav-link" [href]="legacyRoutes.LOGIN" translate>Login</a></li>
        <li class="nav-item"><a class="nav-link" [href]="legacyRoutes.REGISTER" translate>Register</a></li>
      </ul>

      <ul *ngIf="appContext.currentUserProfile.userObject" class="navbar-nav">

        <!-- Language selector -->
        <li class="nav-item d-none d-lg-block">
          <div ngbDropdown class="d-inline-block">
            <button id="languageDropdown" class="btn btn-link no-triangle" ngbDropdownToggle>
              <fa-icon icon="globe"></fa-icon>
            </button>
            <div ngbDropdownMenu aria-labelledby="languageDropdown">
              <a *ngFor="let flag of flags" class="dropdown-item" [href]="legacyRoutes.SET_LANGUAGE(flag.languageCode)">
                <img src="/assets/flags/blank.gif"
                     width="16" height="16"
                     class="flag flag-{{ flag.countryCode }}" />
                {{ flag.label }}
              </a>

              <div class="dropdown-divider"></div>

              <a class="dropdown-item" href="https://translate.astrobin.com/projects" target="_blank">
                <fa-icon icon="tasks"></fa-icon>
                {{ "Help with translations!" | translate }}
              </a>
            </div>
          </div>
        </li>
        <!-- ./Language selector -->

        <!-- User menu -->
        <li class="nav-item">
          <div ngbDropdown class="d-inline-block">
            <button class="btn btn-primary user-dropdown-toggle" id="userDropdown" ngbDropdownToggle>
              {{ appContext.currentUserProfile.userObject.username }}
            </button>

            <div ngbDropdownMenu aria-labelledby="userDropdown">

              <a class="dropdown-item" [href]="legacyRoutes.SUBSCRIPTIONS">
                <fa-icon icon="asterisk"></fa-icon>
                {{ "Subscription plans" | translate }}
              </a>

              <a class="dropdown-item" [href]="legacyRoutes.UPLOAD">
                <fa-icon icon="upload"></fa-icon>
                {{ "Upload" | translate }}
              </a>

              <div class="dropdown-divider"></div>
              <h6 class="dropdown-header" translate>My places</h6>

              <a *ngIf="appContext.currentUserProfile | isProducer"
                class="dropdown-item" [href]="legacyRoutes.COMMERCIAL_PRODUCTS(appContext.currentUserProfile)">
                <fa-icon icon="barcode"></fa-icon>
                {{ "Commercial products" | translate }}
              </a>

              <a
                class="dropdown-item" [href]="legacyRoutes.GALLERY(appContext.currentUserProfile)">
                <fa-icon icon="image"></fa-icon>
                {{ "Gallery" | translate }}
              </a>

              <a
                class="dropdown-item" [href]="legacyRoutes.BOOKMARKS(appContext.currentUserProfile)">
                <fa-icon icon="bookmark"></fa-icon>
                {{ "Bookmarks" | translate }}
              </a>

              <a
                class="dropdown-item" [href]="legacyRoutes.PLOTS(appContext.currentUserProfile)">
                <fa-icon icon="chart-bar"></fa-icon>
                {{ "Plots" | translate }}
              </a>

              <div class="dropdown-divider"></div>
              <h6 class="dropdown-header" translate>Raw data</h6>

              <a
                *ngIf="usersService.hasValidRawDataSubscription(appContext.currentUserProfile)"
                class="dropdown-item" [href]="legacyRoutes.RAWDATA">
                <fa-icon icon="book"></fa-icon>
                {{ "Raw data library" | translate }}
              </a>

              <a
                class="dropdown-item" [href]="legacyRoutes.RAWDATA_PRIVATE_SHARED_FOLDERS">
                <fa-icon icon="lock"></fa-icon>
                {{ "Private shared folders" | translate }}
              </a>

              <div class="dropdown-divider"></div>

              <a
                class="dropdown-item" [href]="legacyRoutes.INBOX">
                <fa-icon icon="inbox"></fa-icon>
                {{ "My messages" | translate }}
              </a>

              <a
                class="dropdown-item" [href]="legacyRoutes.API_KEYS(appContext.currentUserProfile)">
                <fa-icon icon="key"></fa-icon>
                {{ "API Keys" | translate }}
              </a>

              <a
                class="dropdown-item" [href]="legacyRoutes.SETTINGS">
                <fa-icon icon="edit"></fa-icon>
                {{ "My settings" | translate }}
              </a>

              <div class="dropdown-divider"></div>

              <a
                class="dropdown-item" [href]="legacyRoutes.LOGOUT">
                <fa-icon icon="sign-out-alt"></fa-icon>
                {{ "Logout" | translate }}
              </a>

            </div>
          </div>
        </li>
        <!-- ./User menu -->

        <!-- Upload button -->
        <li class="nav-item d-none d-lg-block">
          <a class="btn btn-link nav-link" [href]="legacyRoutes.UPLOAD">
            <fa-icon icon="upload"></fa-icon>
          </a>
        </li>
        <!-- ./Upload button -->

      </ul>
    </div>

  </div> <!-- ./container -->
</nav>
